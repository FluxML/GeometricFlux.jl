<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Message passing scheme · GeometricFlux.jl</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'G-M61P0B2Y8E', 'auto');
ga('send', 'pageview', {'page': location.pathname + location.search + location.hash});
</script><link rel="canonical" href="https://fluxml.ai/GeometricFlux.jl/stable/abstractions/msgpass/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/flux.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="GeometricFlux.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">GeometricFlux.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../start/">Get started</a></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../../basics/conv/">Graph convolutions</a></li><li><a class="tocitem" href="../../basics/layers/">Building layers</a></li><li><a class="tocitem" href="../../basics/passgraph/">Graph passing</a></li></ul></li><li><a class="tocitem" href="../../cooperate/">Cooperate with Flux layers</a></li><li><span class="tocitem">Abstractions</span><ul><li class="is-active"><a class="tocitem" href>Message passing scheme</a><ul class="internal"><li><a class="tocitem" href="#Message-function-1"><span>Message function</span></a></li><li><a class="tocitem" href="#Aggregate-messages-1"><span>Aggregate messages</span></a></li><li><a class="tocitem" href="#Update-function-1"><span>Update function</span></a></li></ul></li><li><a class="tocitem" href="../gn/">Graph network block</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/conv/">Convolutional Layers</a></li><li><a class="tocitem" href="../../manual/pool/">Pooling Layers</a></li><li><a class="tocitem" href="../../manual/models/">Models</a></li><li><a class="tocitem" href="../../manual/linalg/">Linear Algebra</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Abstractions</a></li><li class="is-active"><a href>Message passing scheme</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Message passing scheme</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/FluxML/GeometricFlux.jl/blob/master/docs/src/abstractions/msgpass.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Message-passing-scheme-1"><a class="docs-heading-anchor" href="#Message-passing-scheme-1">Message passing scheme</a><a class="docs-heading-anchor-permalink" href="#Message-passing-scheme-1" title="Permalink"></a></h1><p>Message passing scheme is a popular GNN scheme in many frameworks. It adapts the property of connectivity of neighbors and form a general approach for spatial graph convolutional neural network. It comprises two user-defined functions and one aggregate function. A message function is defined to process information from edge states and node states from neighbors and itself. Messages from each node are obtained and aggregated by aggregate function to provide node-level information for update function. Update function takes current node state and aggregated message and gives a new node state.</p><p>Message passing scheme is realized into a abstract type <code>MessagePassing</code>. Any subtype of <code>MessagePassing</code> is a message passing layer which utilize default message and update functions:</p><pre><code class="language-none">message(mp, x_i, x_j, e_ij) = x_j
update(mp, m, x) = m</code></pre><p><code>mp</code> denotes a message passing layer. <code>message</code> accepts node state <code>x_i</code> for node <code>i</code> and its neighbor state <code>x_j</code> for node <code>j</code>, as well as corresponding edge state <code>e_ij</code> for edge <code>(i,j)</code>. The default message function gives all the neighbor state <code>x_j</code> for neighbor of node <code>i</code>. <code>update</code> takes aggregated message <code>m</code> and current node state <code>x</code>, and then outputs <code>m</code>.</p><h2 id="Message-function-1"><a class="docs-heading-anchor" href="#Message-function-1">Message function</a><a class="docs-heading-anchor-permalink" href="#Message-function-1" title="Permalink"></a></h2><p>A message function accepts feature vector representing node state <code>x_i</code>, feature vectors for neighbor state <code>x_j</code> and corresponding edge state <code>e_ij</code>. A vector is expected to output from <code>message</code> for message. User can override <code>message</code> for customized message passing layer to provide desired behavior.</p><h2 id="Aggregate-messages-1"><a class="docs-heading-anchor" href="#Aggregate-messages-1">Aggregate messages</a><a class="docs-heading-anchor-permalink" href="#Aggregate-messages-1" title="Permalink"></a></h2><p>Messages from message function are aggregated by an aggregate function. An aggregated message is passed to update function for node-level computation. An aggregate function is given by the following:</p><pre><code class="language-none">propagate(mp, fg::FeaturedGraph, aggr::Symbol=:add)</code></pre><p><code>propagate</code> function calls the whole message passing layer. <code>fg</code> acts as an input for message passing layer and <code>aggr</code> represents assignment of aggregate function to <code>propagate</code> function. <code>:add</code> represents an aggregate function of addition of all messages.</p><p>The following <code>aggr</code> are available aggregate functions:</p><p><code>:add</code>: sum over all messages <code>:sub</code>: negative of sum over all messages <code>:mul</code>: multiplication over all messages <code>:div</code>: inverse of multiplication over all messages <code>:max</code>: the maximum of all messages <code>:min</code>: the minimum of all messages <code>:mean</code>: the average of all messages</p><h2 id="Update-function-1"><a class="docs-heading-anchor" href="#Update-function-1">Update function</a><a class="docs-heading-anchor-permalink" href="#Update-function-1" title="Permalink"></a></h2><p>An update function takes aggregated message <code>m</code> and current node state <code>x</code> as arguments. An output vector is expected to be the new node state for next layer. User can override <code>update</code> for customized message passing layer to provide desired behavior.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../cooperate/">« Cooperate with Flux layers</a><a class="docs-footer-nextpage" href="../gn/">Graph network block »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 21 November 2021 15:19">Sunday 21 November 2021</span>. Using Julia version 1.6.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
